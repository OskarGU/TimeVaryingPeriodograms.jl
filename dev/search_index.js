var documenterSearchIndex = {"docs":
[{"location":"Periodograms/#Periodograms","page":"Periodograms","title":"Periodograms","text":"","category":"section"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"Time varying periodograms that can be used as data input in dynamic models that uses spectral likelihoods.","category":"page"},{"location":"Periodograms/#Moving-periodograms","page":"Periodograms","title":"Moving periodograms","text":"","category":"section"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"Based on the periodogram in Häfner and Kirch (2017) - \"Moving Fourier Analysis for Locally Stationary Processes with the Bootstrap in View\". Consider adjustments in form of tapering, pre-whitening and boundary correction.","category":"page"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"mvPeriodogram\nmvTapPeriodogram\nmvPrewhitePeriodogram\nmvPrewhiteTapPeriodogram\nBoundCorrectedMvPeriodogram\ntapBoundCorrectedMvPeriodogram","category":"page"},{"location":"Periodograms/#TimeVaryingPeriodograms.mvPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.mvPeriodogram","text":"  mvPeriodogram(y, m, startFreq) \n\nComputes the moving local periodogram of the time series y using a window size m, starting at frequency startFreq. \n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = mvPeriodogram(y, 10, 2)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.mvTapPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.mvTapPeriodogram","text":"mvTapPeriodogram(y, m, α=1, startFreq=1) \n\nSame as mvPeriodogram but with a Tukey taper applied to the data. Use α=1 for Hanning taper.\n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = mvTapPeriodogramDiffStartFreq(y, 10)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.mvPrewhitePeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.mvPrewhitePeriodogram","text":"  mvPrewhitePeriodogram(y, m, p=nothing, startFreq) \n\nSame as mvPeriodogram but with a Tukey taper applied to the data. Use α=1 for Hanning taper.\n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = mvTapPeriodogramDiffStartFreq(y, 10)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.mvPrewhiteTapPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.mvPrewhiteTapPeriodogram","text":"  mvPrewhiteTapPeriodogram(y, m, p, startFreq) \n\nSame as mvPrewhitePeriodogram but with prewhitening. p is the lag length used in the AR-model, if left blanc the AR order is estimated on each segment.\n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = mvPreWPeriodogram(y, 10, 2, 1)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.BoundCorrectedMvPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.BoundCorrectedMvPeriodogram","text":"    BoundCorrectedMvPeriodogram(y, m, p, startFreq) \n\nSame as mvPeriodogram but with boundary correction in Rao and Yang (2021). ´p´ is the lag length used in the AR-model, if left blanc the AR order is estimated on each segment.\n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = BoundCorrectedMvPeriodogram(y, 10, 2, 1)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.tapBoundCorrectedMvPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.tapBoundCorrectedMvPeriodogram","text":"tapBoundCorrectedMvPeriodogram(y, m, p, startFreq) \n\nSame as ´BoundCorrectedMvPeriodogram´ but with tapering using a Hanning window.\n\nReturns the local periodogram data MIt data and a vector λ with the frequencies where MIt is computed at frequency λ[1 + (t + startFreq - 2) mod m)].\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = tapBoundCorrectedMvPeriodogram(y, 10, 2, 1)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#Block-periodograms","page":"Periodograms","title":"Block periodograms","text":"","category":"section"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"Based on the periodogram used in block-Whittle likelihood, see e.g. Dahlhaus (2012) - \"Locally Stationary Processes\" using the same adjustments as above.","category":"page"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"tvPeriodogram\npreWhiteTvBlockPeriodogram\ntapBoundCorrectTvBlockPeriodogram\nreScaleTapTvBlockPeriodogram","category":"page"},{"location":"Periodograms/#TimeVaryingPeriodograms.tvPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.tvPeriodogram","text":"    tvPeriodogram(y, N, S, nFreq = nothing, taper = nothing; taperArgs...)\n\nComputes the block-periodogram (Dahlhaus, 2012) of the time series y using a window size N, and step-size S on the Fourier frequencies. NFreq can be used to evaluate other frequencies and taper can be used to apply a taper to the data, see package DSP for details. \n\nReturns a spectrogram of the data. \n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia>  tvPeriodogram(y, 25, 15)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.preWhiteTvBlockPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.preWhiteTvBlockPeriodogram","text":"    preWhiteTvBlockPeriodogram(y,N,S,p=nothing)\n\nSame as tvPeriodogram but with pre-whitening. ´p´ is the lag length used in the AR-model, if left blanc the AR order is estimated on each segment.\n\nReturns the local periodogram data MI_t at the Fourier frequencies.\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI = preWhiteTvBlockPeriodogram(y,25,10,p=nothing)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.tapBoundCorrectTvBlockPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.tapBoundCorrectTvBlockPeriodogram","text":"    tapBoundCorrectTvBlockPeriodogram(y,N,S,p=nothing,α=nothing,thresH=0.1^8)\n\nSame as tvPeriodogram but with boundary correction from Rao and Yang (2021). ´p´ is the lag length used in the AR-model, if left blanc the AR order is estimated on each segment.\n\nReturns the local periodogram data MI_t at the Fourier frequencies.\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI = tapBoundCorrectTvBlockPeriodogram(y,25,10,p=nothing,α=nothing,thresH=0.1^8)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.reScaleTapTvBlockPeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.reScaleTapTvBlockPeriodogram","text":"    reScaleTapTvBlockPeriodogram(y,N,S)\n\nSame as tvPeriodogram but with rescaling of the tapered data to match the variance of the non-scaled data. Returns the local periodogram data MI_t at the Fourier frequencies.\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI = reScaleTapTvBlockPeriodogram(y,25,10)\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#Pre-periodograms","page":"Periodograms","title":"Pre-periodograms","text":"","category":"section"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"Preperiodogram based on Neumann and Von Sachs (1997) and Everitt et al. (2013).","category":"page"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"prePeriodogram\nEverittI","category":"page"},{"location":"Periodograms/#TimeVaryingPeriodograms.prePeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.prePeriodogram","text":"prePeriodogram(y, ω)\n\nω is a selected vector of frequencies. Returns a (length(ω) x T-1) matrix containing the prePeriodogram.\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.EverittI","page":"Periodograms","title":"TimeVaryingPeriodograms.EverittI","text":"EverittI(y, ωgrid, ρ, ν)\n\nEveritt et al. version of the pre-periodogram. \n\ny - input time series, \nωgrid - grid of frequencies to be evaluated,  \nρ - Parameter that controls smoothing ove time,\nν - parameter that controlls exponential taper.\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#Time-invariant-periodograms","page":"Periodograms","title":"Time invariant periodograms","text":"","category":"section"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"Time invariant periodograms that are used as parts of the above. Can be interesting for comparison. ","category":"page"},{"location":"Periodograms/","page":"Periodograms","title":"Periodograms","text":"whitePeriodogram\ncompletePeriodogram","category":"page"},{"location":"Periodograms/#TimeVaryingPeriodograms.whitePeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.whitePeriodogram","text":"whitePeriodogram(y, p)\n\nReturns the periodogram from the prewhitening approach using AR-order p.\n\n\n\n\n\n","category":"function"},{"location":"Periodograms/#TimeVaryingPeriodograms.completePeriodogram","page":"Periodograms","title":"TimeVaryingPeriodograms.completePeriodogram","text":"   completePeriodogram(y; fr=nothing, p = nothing, ϕ = nothing, α=nothing, threshold=0.1^8)\n\nComputing the complete periodogram on frequencies, fr (Fourier frquencies if nothing). This is needed in the boundary correction for the dynamic Whittle likellihood.\n\nReturns the complete periodogram of the data given the model.\n\n\n\n\n\n","category":"function"},{"location":"Utils/#Utils","page":"Utils","title":"Utils","text":"","category":"section"},{"location":"Utils/","page":"Utils","title":"Utils","text":"    predictiveDFT\n    completeDFTSingle\n    SingleDft2\n    SpecDensARMA\n    wikleTV6AR\n    DahlhausAR2\n    simTvARMA","category":"page"},{"location":"Utils/#TimeVaryingPeriodograms.predictiveDFT","page":"Utils","title":"TimeVaryingPeriodograms.predictiveDFT","text":"  predictiveDFT(y, ω; p=nothing, ϕ=nothing)\n\nPredictive DFT from Rao and Yang (2021), see r-package \"cspec\" on CRAN. Default is fitting the best AR model and compute the predictive DFT based on the predictions att frequencies ´ω´. ´p´ will fix the AR-order and ´ϕ´ gives the AR-coefficients.\n\nReturns the discrete Fourier coefficients associated with the predictions.\n\nExamples\n\njulia> rand(Normal(500))\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> MI, λ = mvPreWPeriodogram(y, 10, 2, 1)\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.completeDFTSingle","page":"Utils","title":"TimeVaryingPeriodograms.completeDFTSingle","text":"   completeDFTSingle(y, fr; p = nothing, ϕ = nothing)\n\nComputing the complete DFT on a single frequency, fr. This is needed in the boundary correction for the dynamic Whittle likellihood.\n\nReturns the discrete Fourier transform of the data.\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.SingleDft2","page":"Utils","title":"TimeVaryingPeriodograms.SingleDft2","text":"SingleDft2(y, fr)\n\nComputing the DFT on a single frequency, fr. This is needed in the boundary correction for the dynamic Whittle likellihood..\n\nReturns the discrete Fourier transform of the data.\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.SpecDensARMA","page":"Utils","title":"TimeVaryingPeriodograms.SpecDensARMA","text":"SpecDensARMA(ω, ϕ, θ, σ²)\n\nCompute spectral density for the univariate ARMA model. \n\nω is a radial frequency\nϕ is a vector of AR coefficients\nθ is a vector of MA coefficients\nσ² is the noise variance\n\nExamples\n\nThe spectral density for an AR(1) process with unit noise variance is\n\njulia> SpecDensARMA(0.5, 0.9, 0, 1)\n0.6909224383713601\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.wikleTV6AR","page":"Utils","title":"TimeVaryingPeriodograms.wikleTV6AR","text":"wikleTV6AR(T, σ, A, μ)\n\nSimulate spectrogram and time series from a time-varying autoregressive model of order 6.\n\nLength of time series is T, innovation standard deviation is σ, and the AR coefficients are compute from the three-element vector A. The mean of the time series is μ.\n\nExamples\n\njulia> T = 1024; σ = 2; A = [1.1, 1.12, 1.1]; μ = 0;\njulia> y, spdMat, coeffϕ = wikleTV6AR(T, σ, A, μ)\njulia> heatmap(log.(spdMat'), c = :viridis, clim = (-3,1.5), \n    size = (1000,400), title=\"True Spectrogram\");\njulia> plot(y, label = nothing, title = \"Simulated time series from TvAR(6) model\", \n        xlabel = \"time\", ylabel = \"y\")\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.DahlhausAR2","page":"Utils","title":"TimeVaryingPeriodograms.DahlhausAR2","text":"DahlhausAR2(T, σ, μ)\n\nSimulate spectrogram and time series from a time-varying autoregressive model of order 2 from Dahlhaus handbook chapter..\n\nLength of time series is T, innovation standard deviation is σ. The mean of the time series is μ(default is 0).\n\nExamples\n\njulia> T = 1024; σ = 2; μ = 0;\njulia> y, spdMat, coeffϕ = DahlhausAR2(T, σ, μ)\njulia> heatmap(log.(spdMat'), c = :viridis, clim = (-3,1.5), \n    size = (1000,400), title=\"True Spectrogram\");\njulia> plot(y, label = nothing, title = \"Simulated time series from TvAR(2) model\", \n        xlabel = \"time\", ylabel = \"y\")\n\n\n\n\n\n","category":"function"},{"location":"Utils/#TimeVaryingPeriodograms.simTvARMA","page":"Utils","title":"TimeVaryingPeriodograms.simTvARMA","text":"simTvARMA(ϕ, θ, μ, σ)\n\nSimulate a time-varying ARMA process \n\nϕ is a T×p matrix with time evolutions of the p AR coefficients  \nθ is a T×q matrix with time evolutions of the q MA coefficients  \nσ is a T×1 vector with time evolutions of the standard deviation of the noise\nμ is a T×1 vector with time evolutions of the mean of the process\n\nExamples\n\njulia> T = 500; ϕ = [sin.(2π*(1:T)/T) -0.1*ones(T)]; θ = zeros(T); σ = 1; μ = 2;\njulia> y = simTvARMA(ϕ, θ, μ, σ);\njulia> plot(y)\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = TimeVaryingPeriodograms","category":"page"},{"location":"#TimeVaryingPeriodograms","page":"Home","title":"TimeVaryingPeriodograms","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for TimeVaryingPeriodograms.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The package include several ways to compute a time-varying spectrogram that can be used as a part of inference for locally stationary time series models.","category":"page"},{"location":"#Example-usage:","page":"Home","title":"Example usage:","text":"","category":"section"},{"location":"#moving-periodograms","page":"Home","title":"moving periodograms","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using TimeVaryingPeriodograms, Plots, DSP, ProgressBars\ngr(grid = true, legendfontsize=11, xtickfontsize=9, ytickfontsize=9, xguidefontsize=10, yguidefontsize=10,        \n   titlefontsize=14, markersize=5, markerstrokecolor=:auto, background_color=:darkgrey, c=:viridis\n)","category":"page"},{"location":"","page":"Home","title":"Home","text":"We start by simulating a time-varying AR(2) model for illustration. We use 1000 observation and the first AR-coefficient evolves as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"$ \\phi_{1,t} = sin\\left(\\frac{4πt}{T} \\right) + 0.4, \\quad \\text{for }  t \\in 1,\\dots,1000 $","category":"page"},{"location":"","page":"Home","title":"Home","text":"T = 1000; \nϕ = [sin.(2π*(1:2:2T)/T).+0.4 -0.8*ones(T)]; \nθ = zeros(T); \nσ = 1; μ = 2;\ny = simTvARMA(ϕ, θ, 0, σ);\npy = plot(y, label=\"simulated data\", c=:black, background_color=:grey, xlab=time)\npϕ = plot(ϕ[:,1], label=\"AR parameters\", c=:black, background_color=:grey, xlab=\"time\", ylim=(-0.99,1.9))\nplot!(ϕ[:,2], c=:black, background_color=:grey,label=false)\nplot(py,pϕ, size = (1000,350), bottom_margin=4Plots.mm, background_color=:grey)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: A beautiful scenery)","category":"page"},{"location":"","page":"Home","title":"Home","text":"The time-varying spectral density of the process is given by: (Image: A beautiful scenery)","category":"page"},{"location":"","page":"Home","title":"Home","text":"The moving periodogram data is given as a univariate time series of length T-2m, and the periodogram entity of the periodogram data belong to a single frequency, see Gustafsson, Villani, and Kohn (2024). ","category":"page"},{"location":"","page":"Home","title":"Home","text":"The periodogram data is computed for all 4 adjustments using","category":"page"},{"location":"","page":"Home","title":"Home","text":"m=30\nMI, λ = mvPeriodogram(y, m, 1)\nλr = repeat(λ*π, (T-2m)÷m + 1)\nMIBC, λ  = BoundCorrectedMvPeriodogram(y, m, 2, 1)\nMIPreW,λ = mvPrewhitePeriodogram(y, m, 2, 1)\nMITap, λ = mvTapPeriodogram(y, m, 1, 1) ","category":"page"},{"location":"","page":"Home","title":"Home","text":"And the log periodograms can then be plotted using:","category":"page"},{"location":"","page":"Home","title":"Home","text":"scatterRaw  = scatter(m+1:T-m, λr, marker_z=log.(MI), label =false, title = \"raw\", ylab=\"frequency\")\nscatterBC   = scatter(m+1:T-m, λr, marker_z=log.(MIBC), label =false, title = \"boundary corrected\",lab=\"time\")\nscatterPreW = scatter(m+1:T-m, λr, marker_z=log.(MIPreW), label=false, title = \"prewhitened\", xlab=\"time\" lab=\"frequency\")\nscatterTap  = scatter(m+1:T-m, λr, marker_z=log.(MITap),  label =false, title = \"tapered\")\nplot(scatterRaw,scatterTap,scatterPreW,scatterBC, layout = (2,2), clim=(-4,2),\n     size = (1000,600), left_margin=4Plots.mm, background_color=:darkgrey\n)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: A beautiful scenery)","category":"page"},{"location":"","page":"Home","title":"Home","text":"one may notice that when we use this method we loose m observations in the start and end of the series. ","category":"page"},{"location":"#Block-periodograms","page":"Home","title":"Block periodograms","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Corresponding block periodograms data can be are created from ","category":"page"},{"location":"","page":"Home","title":"Home","text":"N=2m+1\nS=20\nBW = tvPeriodogram(y, N, S)\ntapBW = tvPeriodogram(y, N, S, nothing, hanning)\npreWBW =  preWhiteTvBlockPeriodogram(y,N,S,2)\nBCBW =  tapBoundCorrectTvBlockPeriodogram(y,N,S,2,nothing)","category":"page"},{"location":"","page":"Home","title":"Home","text":"and the logs plotted as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"hBW   = heatmap(m+1:S:T-m, λ*π,  log.(BW[1][2:end,:]), title=\"raw\", ylab=\"frequency\")\nhTap  = heatmap(m+1:S:T-m, λ*π,  log.(tapBW[1][2:end,:]), title = \"tapered\")\nhPreW = heatmap(m+1:S:T-m, λ*π,  log.(preWBW'[2:end,:]),title=\"prewhitened\", xlab=\"time\", ylab=\"frequency\")\nhBC   = heatmap(m+1:S:T-m, λ*π,  log.(BCBW'[2:end,:]), title = \"boundary corrected\", xlab=\"time\")\nplot(hBW,hTap,hPreW,hBC, layout = (2,2), size = (1000,600), \n    left_margin=4Plots.mm, background_color=:darkgrey, clim=(-4,2)\n)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: A beautiful scenery)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Note the difference with the moving periodogram that here we instead get multivariate time series observations at roughly TS time points. We have the same problems as before that we loose some observationms at the edges.","category":"page"},{"location":"#Preperiodograms","page":"Home","title":"Preperiodograms","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The preperiodograms can be computed to get maximal time-frequency resolution, however, the data is no longer approximately exponentially distributed. They also come with interfearing cross-terms which make them harder to use. The Everitt et al. version have two smoothing parameters rho and nu which controls smoothing over time and frequency. Below I work with the same number of frequencies as in the above periodograms, but we can have the full vector of Fourier frequencies here.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The preperiodograms can be computed as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"preP = prePeriodogram(y,λ*π)\neverittPeriodogram = EverittI(y, λ*π , 0.4, 0.92)","category":"page"},{"location":"","page":"Home","title":"Home","text":"and be plotted as:","category":"page"},{"location":"","page":"Home","title":"Home","text":"hPreP = heatmap(1:T-1,λ*π, real(preP'), clim=(-1,2), title=\"original\")\nhEverit = heatmap(real(everittPeriodogram)', clim=(-0.1,0.4), title=\"Everitt et al.\") \nplot(hPreP,hEverit, layout = (1,2), size = (1000,300), left_margin=4Plots.mm, \n     bottom_margin=4Plots.mm, background_color=:darkgrey, \n     xlab=\"time\", ylab=\"frequency\", clim=(-0.5,3)\n)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: A beautiful scenery)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Note that the plots are not in logs here since we also obtain negative values.","category":"page"}]
}
